#Include "PROTHEUS.CH" 
#Include "GPER050.CH"   
#Include "REPORT.CH"
#Include "RPTDEF.CH"
#Include "FWPrintSetup.ch"

#DEFINE nRA_FILIAL 	1
#DEFINE nRA_CC     	2
#DEFINE nRA_MAT		3
#DEFINE nRA_NOME	4 

#DEFINE nNFL_LCR_BS 1
#DEFINE nNFL_LCR_IR 2
#DEFINE nNADIAN_BS 	3
#DEFINE nNADIAN_IR 	4
#DEFINE nNFER_BS   	5
#DEFINE nNFER_IR   	6
#DEFINE nN13SAL_BS 	7
#DEFINE nN13SAL_IR 	8
#DEFINE nNPLR_BS   	9
#DEFINE nNPLR_IR   	10
#DEFINE nNTOTAIS_BS 11
#DEFINE nNTOTAIS_IR 12

Static nTpImpre := 0
Static aOrdCab
Static aOrdDet


User Function CFINR085(cNomeDarf,cDarfDir, lRelatorio)

Local aArea			 := GetArea()
Local cTmpPath       := GetTempPath()
Private cNomeRel     := cNomeDarf
Private cDirRel      := cDarfDir
Private cPerg   	 := ''
Private oReport   	 := Nil
Private cDesc1		 := OemToAnsi(STR0039) + " " + OemToAnsi(STR0002) + " " + OemToAnsi(STR0003)//"Dirf Mensal" ### "Ser impresso de acordo com os parametros solicitados pelo"  ### "usurio."
Private cTit    	 := OemToAnsi(STR0011)			//"RELATORIO DIRF MENSAL"                                                         

Private wnrel     := "GPER050"            //Nome Default do relatorio em Disco
Private lIRMesAnt := .T.

Default lRelatorio :=  .T.

If lRelatorio
	fRadioPerg(@nTpImpre, @cPerg)
Else
	nTpImpre := 2
EndIf

SetMnemonicos(NIL,NIL,.T.)

If nTpImpre == 1
	cPerg := 'GP050R'
	Pergunte(cPerg, .F.)
	oReport := ReportDef(cPerg)
	oReport:PrintDialog()
Else
	cPerg := 'GPR050'
	Pergunte(cPerg, .F.)
	If Empty(Mv_Par13)
		Pergunte(cPerg, .T.)
	EndIf 	
	GR050Imp(1, .F., WnRel, "SRA", "1", oReport, "GPER050")
EndIf

If lRelatorio
	FERASE(cTmpPath + "DARF_APURACAO_IR_BOLSA_AUXILIO" + ".pdf") 
	CpyS2T(cDirRel + cNomeRel + ".pdf" , cTmpPath , .F. )
	
	If File(cTmpPath+cNomeRel+".pdf")
		ShellExecute("OPEN",cTmpPath+cNomeRel+".pdf","","",5)
	Else
		MSGALERT("Nใo foi possํvel realizar a c๓pia do relat๓rio para o diret๓rio:" + CRLF + cTmpPath)
	EndIf
EndIf

RestArea( aArea )

Return()

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑฺฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤฟฑฑ
ฑฑณFuno    ณ ReportDef  ณ Autor ณ Tania Bronzeri        ณ Data ณ13/06/2006ณฑฑ
ฑฑรฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤดฑฑ
ฑฑณDescriao ณ Relatorio de Imposto de Renda / DIRF                         ณฑฑ
ฑฑรฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤดฑฑ
ฑฑณSintaxe   ณ GPER050(void)                                                ณฑฑ
ฑฑรฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤดฑฑ
ฑฑณParametrosณ                                                              ณฑฑ
ฑฑรฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤดฑฑ
ฑฑณ Uso      ณ GPER050 - Generico - Release 4                               ณฑฑ
ฑฑภฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤูฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/

Static Function ReportDef(cPerg)

Local oSection1 := Nil
Local oSecCab   := Nil
//Local oCell	    := Nil
Local cTitulo	:= OemToAnsi(STR0011) //"RELATORIO DIRF MENSAL"
Local nTamSRA   := 2 //Utilizada para nColSpace (Tamanho da Matrํcula)

// Criacao do componente de impressao
DEFINE REPORT oReport NAME "GPER050" TITLE cTitulo PARAMETER cPerg ACTION {|oReport| R050Imp(oReport)} DESCRIPTION OemtoAnsi(STR0022) //"RELATORIO DIRF MENSAL" ### "Emite Relacao do Imposto de Renda - Dirf Mensal." 
oReport:SetTotalInLine(.F.)

Pergunte("GP050R",.F.)

//                     New(oParent, cTitle            , uTable , aOrder                                                    ,  lLoadCells    , lLoadOrder    , uTotalText    , lTotalInLine    , lHeaderPage    , lHeaderBreak    , lPageBreak    , lLineBreak    , nLeftMargin     , lLineStyle          , nColSpace    , lAutoSize       , cCharSeparator       , nLinesBefore    , nCols    , nClrBack    , nClrFore    , nPercentage    )
oSecCab := TRSection():New(oReport, OemToAnsi(STR0001), {"SRA"}, {OemToAnsi(STR0004),OemToAnsi(STR0005),OemToAnsi(STR0006)},  /*lLoadCells*/, /*lLoadOrder*/, /*uTotalText*/, /*lTotalInLine*/, /*lHeaderPage*/, /*lHeaderBreak*/, /*lPageBreak*/, /*lLineBreak*/, 0/*nLeftMargin*/, .F./*lLineStyle*/   , /*nColSpace*/, .F./*lAutoSize*/, "|"/*cCharSeparator*/, 50/*nLinesBefore*/, /*nCols*/, /*nClrBack*/, /*nClrFore*/, /*nPercentage*/) // "Contribuicoes" ### "Matrกcula" ### "Centro de Custo" ### "Nome"
oSecCab:SetTotalInLine(.F.)
oSecCab:SetLinesBefore(0)

TRCell():New(oSecCab, "RA_FILIAL"  , "SRA" , OemToAnsi(Alltrim(STR0023)), /*Picture*/			, /*Tamanho*/, /*lPixel*/   , /*{|| code-block de impressao }*/ 										    , "LEFT"	,  	.F.			,"LEFT"		    ,				,				,.F.	  , /*12632256*/   	,				,			)
TRCell():New(oSecCab, "RA_CC"      , "SRA" , OemToAnsi(Alltrim(STR0024)), /*Picture*/			, /*Tamanho*/, /*lPixel*/   , /*{|| code-block de impressao }*/ 										    , "LEFT"	,	.F.			,"LEFT"		    ,				,				,.F.	  , /*32768*/        ,				,			)
TRCell():New(oSecCab, "RA_MAT"     , "SRA" , OemToAnsi(Alltrim(STR0025)), /*Picture*/			, /*Tamanho*/, /*lPixel*/   , /*{|| code-block de impressao }*/ 										    , "LEFT"	,	.F.			,"LEFT"		    ,				,nTamSRA      ,.F.	  , /*12632256*/     ,				,			)
TRCell():New(oSecCab, "RA_NOME"    , "SRA" , /*Titulo Coluna*/          , /*Picture*/			, /*Tamanho*/, /*lPixel*/   , /*{|| code-block de impressao }*/										    , "LEFT"	,	.F.			,"LEFT"		    ,				,				,.F.	  , /*32768*/	       ,				,			)

oSection1 := TRSection():New(oReport, OemToAnsi(STR0001), {}, {OemToAnsi(STR0004),OemToAnsi(STR0005),OemToAnsi(STR0006)}, /*lLoadCells*/, /*lLoadOrder*/, /*uTotalText*/, /*lTotalInLine*/, /*lHeaderPage*/, /*lHeaderBreak*/, /*lPageBreak*/, /*lLineBreak*/, 0/*nLeftMargin*/, .F./*lLineStyle*/   , /*nColSpace*/, .F./*lAutoSize*/, "|"/*cCharSeparator*/, /*nLinesBefore*/, /*nCols*/, /*nClrBack*/, /*nClrFore*/, /*nPercentage*/) // "Contribuicoes" ### "Matrกcula" ### "Centro de Custo" ### "Nome"
oSection1:SetTotalInLine(.F.)
oSection1:SetLinesBefore(0)

TRCell():New(oSection1, "NFL_LCR_BS" , "  "  , OemToAnsi(Alltrim(STR0060)), "@E 999,999,999.99" , 14         , /*lPixel*/   , {|| aFolBas[_nTipo] }                                                                        , "RIGHT" ,   .F.      ,"RIGHT"       ,           ,          ,.F.       , /*12632256*/ ,         ,      )
TRCell():New(oSection1, "NFL_LCR_IR" , "  "  , OemToAnsi(Alltrim(STR0061)), "@E   9,999,999.99" , 12         , /*lPixel*/   , {|| aFolIR [_nTipo] }                                                                        , "RIGHT" ,   .F.      ,"RIGHT"       ,           ,          ,.F.       , /*32768*/    ,         ,      )
TRCell():New(oSection1, "NADIAN_BS"  , "  "  , OemToAnsi(Alltrim(STR0028)), "@E 999,999,999.99" , 14         , /*lPixel*/   , {|| aAdiBas[_nTipo] }                                                                        , "RIGHT" ,   .F.      ,"RIGHT"       ,           ,          ,.F.       , /*12632256*/ ,         ,      )
TRCell():New(oSection1, "NADIAN_IR"  , "  "  , OemToAnsi(Alltrim(STR0029)), "@E   9,999,999.99" , 12         , /*lPixel*/   , {|| aAdiIR [_nTipo] } /*{|| code-block de impressao }*/                                      , "RIGHT" ,   .F.      ,"RIGHT"       ,           ,          ,.F.       , /*32768*/    ,         ,      )
TRCell():New(oSection1, "NFER_BS"    , "  "  , OemToAnsi(Alltrim(STR0030)), "@E 999,999,999.99" , 14         , /*lPixel*/   , {|| aFerBas[_nTipo] } /*{|| code-block de impressao }*/                                      , "RIGHT" ,   .F.      ,"RIGHT"       ,           ,          ,.F.       , /*12632256*/ ,         ,      )
TRCell():New(oSection1, "NFER_IR"    , "  "  , OemToAnsi(Alltrim(STR0031)), "@E   9,999,999.99" , 12         , /*lPixel*/   , {|| aFerIR [_nTipo] } /*{|| code-block de impressao }*/                                      , "RIGHT" ,   .F.      ,"RIGHT"       ,           ,          ,.F.       , /*32768*/    ,         ,      )
TRCell():New(oSection1, "N13SAL_BS"  , "  "  , OemToAnsi(Alltrim(STR0032)), "@E 999,999,999.99" , 14         , /*lPixel*/   , {|| a13Bas [_nTipo] } /*{|| code-block de impressao }*/                                      , "RIGHT" ,   .F.      ,"RIGHT"       ,           ,          ,.F.       , /*12632256*/ ,         ,      )
TRCell():New(oSection1, "N13SAL_IR"  , "  "  , OemToAnsi(Alltrim(STR0033)), "@E   9,999,999.99" , 12         , /*lPixel*/   , {|| a13IR  [_nTipo] } /*{|| code-block de impressao }*/                                      , "RIGHT" ,   .F.      ,"RIGHT"       ,           ,          ,.F.       , /*32768*/    ,         ,      )
TRCell():New(oSection1, "NPLR_BS"    , "  "  , OemToAnsi(Alltrim(STR0056)), "@E 999,999,999.99" , 14         , /*lPixel*/   , {|| aPLRBas[_nTipo] } /*{|| code-block de impressao }*/                                      , "RIGHT" ,   .F.      ,"RIGHT"       ,           ,          ,.F.       , /*12632256*/ ,         ,      )
TRCell():New(oSection1, "NPLR_IR"    , "  "  , OemToAnsi(Alltrim(STR0057)), "@E   9,999,999.99" , 12         , /*lPixel*/   , {|| aPLRIR [_nTipo] } /*{|| code-block de impressao }*/                                      , "RIGHT" ,   .F.      ,"RIGHT"       ,           ,          ,.F.       , /*32768*/    ,         ,      )
TRCell():New(oSection1, "NTOTAIS_BS" , "  "  , OemToAnsi(Alltrim(STR0034)), "@E 999,999,999.99" , 14         , /*lPixel*/   , {|| aFolBas[_nTipo] + aAdiBas[_nTipo] + aFerBas[_nTipo] + a13Bas[_nTipo] + aPLRBas[_nTipo] } , "RIGHT" ,   .F.      ,"RIGHT"       ,           ,          ,.F.       , /*12632256*/ ,         ,      )
TRCell():New(oSection1, "NTOTAIS_IR" , "  "  , OemToAnsi(Alltrim(STR0035)), "@E 999,999,999.99" , 14         , /*lPixel*/   , {|| aFolIR [_nTipo] + aAdiIR [_nTipo] + aFerIR [_nTipo] + a13IR [_nTipo] + aPLRIR[_nTipo] }  , "RIGHT" ,   .F.      ,"RIGHT"       ,           ,          ,.F.       , /*32768*/    ,         ,      )

Return(oReport)

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณGPER050   บAutor  ณMicrosiga           บ Data ณ  11/09/06   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ                                                            บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ AP                                                         บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/

Static Function R050Imp(oReport)

	GR050Imp(1,.F.,WnRel,"SRA","1",oReport,"GPER050")

Return(Nil)

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบFuncao    ณGR050Imp  บAutor  ณMicrosiga           บ Data ณ  01/10/07   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ                                                            บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ AP                                                         บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function GR050Imp(nTipGer, lEnd, WnRel,cString,cAgrupa,oReport,cFonte,lRRA,cTipoRet)

Default lRRA    	:= .F.
Private lTitRRA 	:= lRRA 
Private lPLR 		:= .F. 
Private lGper060 	:= FunName() == "GPER060"

//No caso de impressใo em planilha, suprimindo linhas em branco e totais e formato sint้tico,
//Deixarแ de suprimir as linhas em branco e totais, caso contrแrio nada seria impresso/gerado.
If Valtype(oReport) == "O" .ANd. oReport:nDevice == 4 .And. !oReport:lEmptyLineExcel .And. mv_par11 == 2
	oReport:lEmptyLineExcel := .T.
Endif

R050Impressao(nTipGer,lEnd,WnRel,cString,cAgrupa,oReport,cFonte,cTipoRet)

Return()

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณGPER050   บAutor  ณMicrosiga           บ Data ณ  01/10/07   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ                                                            บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ AP                                                         บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function R050Impressao(nTipGer, lEnd, WnRel,cString,cAgrupa,oReport,cFonte,cTipoRet)

Local cFilter 		:= ""

Default cTipoRet    := ""
Default cFonte      := "GPER050"

If !lGper060 .And. Valtype(oReport) == "U"
	oReport     := ReportDef()
	If nTipGer != 2
		Private nOrdem
	EndIf 
Else
	Pergunte("GP050R",.F.)
EndIf

Private cCcDe        	:= mv_par03
Private cCcAte       	:= mv_par04
Private cNomDe       	:= mv_par07
Private cNomAte      	:= mv_par08
Private dDataDe      	:= mv_par09
Private dDataAte     	:= mv_par10
Private cSinAna      	:= Iif(mv_par11 == 1,"A","S")
Private lGeraTitulo  	:= (nTipGer == 2)//Verifica se ้ gera็ใo de tํtulo(GPEM650)
Private oBreakFil	    := Nil
Private oBreakCCusto 	:= Nil	
Private cAcessaSRA   	:= &("{ || " + ChkRH("GPER050","SRA","2") + "}")
Private cTitCC	   		:= "" 
Private cTitFil	    	:= ""
Private cTit	       	:= ""
Private cTitulo     	:= ""
Private Titulo	    	:= '' 
Private lGp050Fil    	:= ExistBlock( "GP050FIL" )//variavel p/ PE GP050FIL 
Private lRetPE       	:= .F.//variavel p/ PE GP050FIL
Private aVerba	    	:= {}
Private cVerbaSql		:= ""
Private aPerAberto   	:= {}
Private aPerFechado  	:= {}
Private oSecCab      
Private oSection1    
Private lSalta       := .F. 
Private nTipImp      := IiF(lGeraTitulo, nTipImp, IiF(nTpImpre # Nil, nTpImpre, 1))
Private dVencto      := CtoD('//')
Private cNumRef      := ''
Private cCentra      := ''
Private cSvRet       := ''
Private cOldRet	     := ''
Private aInfo        := {}
Private aCodFol      := {}
Private aCodLido     := {}
Private lRecalcIR    := .F.
Private aFolBas[4] 
Private aAdiBas[4] 
Private aFerBas[4] 
Private a13Bas [4]
Private aFolIR [4]  
Private aAdiIR [4]  
Private aFerIR [4]  
Private a13IR  [4]
Private aPLRBas[4]
Private aPLRIR [4]

Private lImpRelato  := (nTipGer == 1    )  //Na geracao de titulo fincanceiro vem com valor diferente
Private lAgrupFil   := (cAgrupa == "1"  )
Private lAgrupCc    := (cAgrupa $  "2*3")
Private lAgrupFunc  := (cAgrupa == "4"  )
Private aReturn 	:= {STR0007,1,STR0008, 1, 2, 1, "",1 }	// "Zebrado"###"Administrao"
Private nomeprog	:= "GpeR050"
Private aLinha  	:= {}
Private nLastKey 	:= 0

If !lGper060
	oSecCab      := oReport:Section(1)
	oSection1    := oReport:Section(2)
	nOrdem := Iif(lGeraTitulo, nOrdem, oSecCab:GetOrder())   
EndIf

If ! FunName() $ "GPER060|GPEM650"
	Private cFilDe       := mv_par01
	Private cFilAte      := mv_par02
	Private cMatDe       := mv_par05
	Private cMatAte      := mv_par06
EndIf

nTpImpre := Iif(lGeraTitulo, 2, nTpImpre)

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ  Altera o Titulo do Relatorio conforme o parametro selecionado   ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
cTit  	 := OemToAnsi(STR0012) + DTOC(dDataDe) + " - " + DTOC(dDataAte)	//"RELATORIO DIRF MENSAL              Periodo: "
cTitulo  := If(AllTrim(lGper060 .Or. oReport:Title())==AllTrim(cTitulo),cTit,oReport:Title())

If Type('mv_par12') == 'N'
	lSalta   := Iif(mv_par12 == 1,.T.,.F.)
ElseIf Type('mv_par12') == 'C'
	lSalta   := Iif(mv_par12 == 'S',.T.,.F.)
EndIf

If nTpImpre == 1
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ  Altera o titulo do relatorio                                    ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	oReport:SetTitle(cTit)
	
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ  Quebra de pagina                                                ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	If  nOrdem == 2  
		
		//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
		//ณ Quebrar por Centro de Custo                                      ณ
		//ณ Total Centro de Custo                                            ณ
		//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
		oBreakCCusto:= TRBreak():New(IIf(cSinAna == 'A',oSecCab,oSection1), {||oSecCab:Cell(nRA_FILIAL):GetText()+'-'+oSecCab:Cell(nRA_CC):GetText()},OemToAnsi(STR0037), .F.)	//"Total do Centro de Custo"

		If lSalta
			oBreakCCusto:SetPageBreak()
		Endif
		TRFunction():New(oSection1:Cell(nNFL_LCR_BS ), , "SUM", oBreakCCusto, STR0062, "@E 999,999,999.99", ,.F., .F.) //Total Fol./Lucro Base
		TRFunction():New(oSection1:Cell(nNFL_LCR_IR ), , "SUM", oBreakCCusto, STR0063, "@E 999,999,999.99", ,.F., .F.) //Total Fol./Lucro IR
		TRFunction():New(oSection1:Cell(nNADIAN_BS  ), , "SUM", oBreakCCusto, STR0046, "@E 999,999,999.99", ,.F., .F.) //Total Adiant. Base
		TRFunction():New(oSection1:Cell(nNADIAN_IR  ), , "SUM", oBreakCCusto, STR0047, "@E 999,999,999.99", ,.F., .F.) //Total Adiant. IR
		TRFunction():New(oSection1:Cell(nNFER_BS    ), , "SUM", oBreakCCusto, STR0048, "@E 999,999,999.99", ,.F., .F.) //Total Ferias Base
		TRFunction():New(oSection1:Cell(nNFER_IR    ), , "SUM", oBreakCCusto, STR0049, "@E 999,999,999.99", ,.F., .F.) //Total Ferias IR
		TRFunction():New(oSection1:Cell(nN13SAL_BS  ), , "SUM", oBreakCCusto, STR0050, "@E 999,999,999.99", ,.F., .F.) //Total 13.Sal. Base
		TRFunction():New(oSection1:Cell(nN13SAL_IR  ), , "SUM", oBreakCCusto, STR0051, "@E 999,999,999.99", ,.F., .F.) //Total 13.Sal. IR
		TRFunction():New(oSection1:Cell(nNPLR_BS    ), , "SUM", oBreakCCusto, STR0058, "@E 999,999,999.99", ,.F., .F.) //Total PLR Base
		TRFunction():New(oSection1:Cell(nNPLR_IR    ), , "SUM", oBreakCCusto, STR0059, "@E 999,999,999.99", ,.F., .F.) //Total PLR IR
		TRFunction():New(oSection1:Cell(nNTOTAIS_BS ), , "SUM", oBreakCCusto, STR0052, "@E 999,999,999.99", ,.F., .F.) //Totais Bases
		TRFunction():New(oSection1:Cell(nNTOTAIS_IR ), , "SUM", oBreakCCusto, STR0053, "@E 999,999,999.99", ,.F., .F.) //Totais IR
	
		oBreakCCusto:OnBreak({|x,y| cTitCC:=OemToAnsi(STR0037)+": "+x})	//"Total do Centro de Custo"
		oBreakCCusto:SetTotalText({||cTitCC})
		
		oBreakCCusto:OnPrintTotal({|x,y| fPosQuebra()})
	EndIf
	
	oBreakFil:= TRBreak():New(IIf(cSinAna == 'A',oSecCab,oSection1), oSecCab:Cell("RA_FILIAL"),OemToAnsi(STR0036), .F.)	//"Total da Filial"
	oBreakFil:SetPageBreak()
	
	TRFunction():New(oSection1:Cell(nNFL_LCR_BS ), , "SUM", oBreakFil, STR0062, "@E 999,999,999.99", , .F., .T.) //Total Fol./Lucro Base
	TRFunction():New(oSection1:Cell(nNFL_LCR_IR ), , "SUM", oBreakFil, STR0063, "@E 999,999,999.99", , .F., .T.) //Total Fol./Lucro IR
	TRFunction():New(oSection1:Cell(nNADIAN_BS  ), , "SUM", oBreakFil, STR0046, "@E 999,999,999.99", , .F., .T.) //Total Adiant. Base
	TRFunction():New(oSection1:Cell(nNADIAN_IR  ), , "SUM", oBreakFil, STR0047, "@E 999,999,999.99", , .F., .T.) //Total Adiant. IR
	TRFunction():New(oSection1:Cell(nNFER_BS    ), , "SUM", oBreakFil, STR0048, "@E 999,999,999.99", , .F., .T.) //Total Ferias Base
	TRFunction():New(oSection1:Cell(nNFER_IR    ), , "SUM", oBreakFil, STR0049, "@E 999,999,999.99", , .F., .T.) //Total Ferias IR
	TRFunction():New(oSection1:Cell(nN13SAL_BS  ), , "SUM", oBreakFil, STR0050, "@E 999,999,999.99", , .F., .T.) //Total 13.Sal. Base
	TRFunction():New(oSection1:Cell(nN13SAL_IR  ), , "SUM", oBreakFil, STR0051, "@E 999,999,999.99", , .F., .T.) //Total 13.Sal. IR
	TRFunction():New(oSection1:Cell(nNPLR_BS    ), , "SUM", oBreakFil, STR0058, "@E 999,999,999.99", , .F., .T.) //Total PLR Base
	TRFunction():New(oSection1:Cell(nNPLR_IR    ), , "SUM", oBreakFil, STR0059, "@E 999,999,999.99", , .F., .T.) //Total PLR IR
	TRFunction():New(oSection1:Cell(nNTOTAIS_BS ), , "SUM", oBreakFil, STR0052, "@E 999,999,999.99", , .F., .T.) //Totais Bases
	TRFunction():New(oSection1:Cell(nNTOTAIS_IR ), , "SUM", oBreakFil, STR0053, "@E 999,999,999.99", , .F., .T.) //Totais IR
	
	oBreakFil:OnBreak({|x,y|cTitFil:=OemToAnsi(STR0036)+": "+x})	//"Total da Filial"
	oBreakFil:SetTotalText({||cTitFil})

	oSecCab:SetHeaderBreak  (.T.)
	oSecCab:SetHeaderPage   (.T.)

	oSection1:SetHeaderBreak  (.T.)
	oSection1:SetHeaderPage   (.T.)	

	ProcesDarf(lEnd)
	
	oSection1:Finish()
	oSecCab:Finish()
		
Else 

	If !lGeraTitulo
		oFont07	  := TFont():New("Arial"      , 10, 10, ,.F. ,,,,.T.,.F.)
		oFont08	  := TFont():New("Arial"      , 10, 10, ,.F. ,,,,.T.,.F.)  
		oFont10	  := TFont():New("Arial"      , 10, 10, ,.F. ,,,,.T.,.F.)
		oFont10n  := TFont():New("Arial"      , 10, 10, ,.T. ,,,,.T.,.F.)		//negrito
		oFont11	  := TFont():New("Courier New", 10, 10, ,.F. ,,,,.T.,.F.)
		oFont12   := TFont():New("Arial"	  , 12, 12, ,.F. ,,,,.T.,.F.)
		oFont15n  := TFont():New("Arial"      , 20, 20, ,.T. ,,,,.T.,.F.)		//negrito
		oFont21n  := TFont():New("Arial"      , 15, 15, ,.T. ,,,,.T.,.F.)		//negrito
		oPrint 	  := TMSPrinter():New(STR0041) 									//"DARF - Guia de Recolhimento DARF"
		
		FERASE("\spool\"+cNomeRel+".pdf")
		FERASE("\spool\"+cNomeRel+".rel")
		
		oPrint:= FWMSPrinter():New(cNomeRel+".rel",IMP_PDF,.T.,"\spool\",.T.,.F.,,,.T.,.T.)	
		oPrint:nDevice  := IMP_PDF
	    oPrint:cPathPDF := "\spool\"      
		oPrint:lServer  := .T.
		oPrint:lViewPDF := .F.	
		//oPrint:StartPage()
		/*wnrel     := SetPrint(cString,wnrel,cPerg,Titulo,cDesc1,,,	.F., ,.T., 'M' )
		oPrint:StartPage()*/
		oPrint:SetPortrait()
	EndIf
	//Botใo Cancelar
	If	nLastKey == 27
		Return
	EndIf
	
	cFilter := aReturn[7]

	If Type('mv_par12') == 'N'
		lSalta   := Iif(mv_par12 == 1,.T.,.F.)
	ElseIf Type('mv_par12') == 'C'
		lSalta   := Iif(mv_par12 == 'S',.T.,.F.)
	EndIf
	
		
	if !lGeraTitulo
		If nTpImpre # 1
			nTipImp := mv_par13+1
		EndIf
		dVencto   := mv_par14
		cNumRef   := mv_par15
		cCentra   := mv_par16
		lPLR      := If(mv_par17 == 1, .T., .F.)
	else // GPEM650
		Pergunte("GPM650", .F.)
		dVencto   := mv_par13
		cNumRef   := ""
		cCentra   := ""
	endif

	If FunName() == "GPER060"
		ProcesDarf()
	Else
		Processa( {|| ProcesDarf(@lEnd, cFilter)}, STR0054, STR0055, .F.)
	EndIf

	IF aReturn[5] == 3 .AND. nTipImp == 2
		oPrint:Print()
	Else
		if !lGeraTitulo // Nใo executa a impressใo caso venha de GPEM650
			oPrint:Preview() // Visualiza impressao grafica antes de imprimir
		Endif
	ENDIF
EndIf
	
fVerTransf(.T.)

Return(Nil)

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณfVerTransfบAutor  ณMauricio MR         บ Data ณ  04/05/10   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณObtem as transferencias para tratamento de ferias			  บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ GPER050			                                          บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function fVerTransf(lZera, aAuxTransf, cCompet, cCodEmp, cCodFil, cCodMat )
Static cChaveAnt:= '!!'

Default lZera	:= .F.

If lZera
   cChaveAnt := Nil
Else   
	If cChaveAnt <> ( cCodEmp + cCodFil + cCodMat )
		cChaveAnt  := ( cCodEmp + cCodFil + cCodMat )
		aAuxTransf := {}
		fTransf(@aAuxTransf, , Nil, Nil, Nil, Nil, .F., .T.,,,,, cCodFil, cCodMat)
	Endif	
Endif
Return(.T.)
/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณfSoma     บAutor  ณMauricio MR         บ Data ณ  04/05/10   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณObtem as transferencias para tratamento de ferias			  บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ GPER050			                                          บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function fSoma(cVetor,nVal,cCodVerba,dDataPagto,lSoma, cTipo2, cCCRat, cSemana, cRoteiro,cPer )

Local cChaveBusca := cCodVerba + DTOS(dDataPagto) + If( cTipo2 $ "G/R", "C", cTipo2) + cCCRat + cSemana + cRoteiro 
Local nFor 		  := 0
DEFAULT cPer 	  := ""

cChaveBusca += cPer

lSoma := If(lSoma == Nil,.F.,lSoma)

If ((aScan( aCodLido, cChaveBusca ) == 0 .Or. lRecalcIR) .AND. lSoma  ) .OR. ( !lSoma ) .OR. ( nVal < 0 )
	cVet := "a" + cVetor
	If ( lSoma )
		aAdd(aCodLido, cChaveBusca )
	EndIf	
	
	For nFor = 1 To 4
		&(cVet)[nFor] += nVal
	Next nFor
EndIf   

Return(Nil)

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณFZeraAcumuบAutor  ณMauricio MR         บ Data ณ  04/05/10   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณObtem as transferencias para tratamento de ferias			  บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ GPER050			                                          บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function FZeraAcumuladores(nDe,nAte)
Local nFor := 0

For nFor := nDe To nAte
	aFolBas[nFor] := 0
	aAdiBas[nFor] := 0
	aFerBas[nFor] := 0
	a13Bas [nFor] := 0
	aFolIR [nFor] := 0
	aAdiIR [nFor] := 0
	aFerIR [nFor] := 0
	a13IR  [nFor] := 0
	aPLRBas[nFor] := 0
	aPLRIR [nFor] := 0
Next nFor
Return(Nil)

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณFTotAcumulบAutor  ณMauricio MR         บ Data ณ  04/05/10   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณObtem as transferencias para tratamento de ferias			  บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ GPER050			                                          บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function FTotAcumuladores(nDe,nAte)
Local nTotal := 0
Local nFor	 := 0

For nFor := nDe To nAte
	nTotal += aFolBas[nFor]
	nTotal += aAdiBas[nFor]
	nTotal += aFerBas[nFor]
	nTotal += a13Bas [nFor]
	nTotal += aFolIR [nFor]
	nTotal += aAdiIR [nFor]
	nTotal += aFerIR [nFor]
	nTotal += a13IR  [nFor]
	nTotal += aPLRBas[nFor]
	nTotal += aPLRIR [nFor]
Next nFor 
Return(nTotal)

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณfTestaTotaบAutor  ณMauricio MR         บ Data ณ  04/05/10   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณExecuta Quebras                                             บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ GPER050			                                          บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function fTestaTotal()
cFilAnterior := (cAliasSRA)->RA_FILIAL
cFilQuebra   := (cAliasSRA)->RA_FILIAL
cCcAnt       := (cAliasSRA)->RA_CC

If !lGper060
	oSecCab:Cell(nRA_FILIAL):SetValue((cAliasSRA)->RA_FILIAL)
	oSecCab:Cell(nRA_CC    ):SetValue((cAliasSRA)->RA_CC)
	oSecCab:Cell(nRA_MAT   ):SetValue((cAliasSRA)->RA_MAT)
	oSecCab:Cell(nRA_NOME  ):SetValue((cAliasSRA)->RA_NOME)
EndIf
(cAliasSRA)->(dbSkip())

If Eof() 
	fImpCc()
	fImpFil()
	fImpEmp()
Elseif (cFilAnterior != (cAliasSRA)->RA_FILIAL  .And. Empty(cCentra) ) ;
		.Or. (cFilAnterior != (cAliasSRA)->RA_FILIAL .And. !Empty(cCentra) .And. nTipImp == 1); 
       .Or. (nTipImp # 1 .And. ((cAliasSRA)->RA_CODRET # cOldRet .And. !(cOldRet $ "3562/0561/    " .And. (cAliasSRA)->RA_CODRET $ "0561/    ")))
	fImpCc() 
	fImpFil()            
Elseif cCcAnt # (cAliasSRA)->RA_CC .And. !Eof()
	fImpCc() 
Endif
Return(Nil)

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณfImpFun   บAutor  ณMauricio MR         บ Data ณ  04/05/10   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณImprime um Funcionario                                      บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ GPER050			                                          บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function fImpFun()

_nTipo := 4
//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Verifica se Acumulador de funcionarios > 0                   ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
If FTotAcumuladores(4,4) == 0 
	Return(Nil)
Endif

If lImpRelato
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Imprime funcionario                                          ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	fImprime(4) 
ElseIf lGeraTitulo .And. lAgrupFunc  .And. FunName() == "GPEM650" .and. (cSinAna == "A" )
	fGravTit( (cAliasSRA)->RA_FILIAL, (cAliasSRA)->RA_CC, (cAliasSRA)->RA_MAT, aFolIR[4]+aAdiIR[4]+aFerIR[4]+a13IR[4] )
ElseIf FunName() == "GPER060"
	aFolBas2 := aClone(aFolBas) 
	aFolIR2  := aClone(aFolIR) 
	aFerBas2 := aClone(aFerBas) 
	aFerIR2  := aClone(aFerIR) 
	a13Bas2  := aClone(a13Bas) 
	a13IR2 	 := aClone(a13IR) 
Endif

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Zera Acumuladores do Funcionario                             ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
FZeraAcumuladores(4,4)  

Return(Nil)

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณfImpCc    บAutor  ณMauricio MR         บ Data ณ  04/05/10   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณImprime Centro de Custo					                  บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ GPER050			                                          บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function fImpCc()
_nTipo := 3

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Verifica se Acumulador de Centro de Custo > 0                ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
If FTotAcumuladores(3,3) == 0 
	Return(Nil)
Endif

If nOrdem ==  2
	If lImpRelato
		//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
		//ณ Imprime Tot Centro de Custo                                  ณ
		//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
		fImprime(3) 
	ElseIf lGeraTitulo .And. lAgrupCc
		fGravTit( cFilAnterior, cCcAnt, , aFolIR[3]+aAdiIR[3]+aFerIR[3]+a13IR[3] )
	EndIf
Endif
//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Zera Acumuladores de Centro de Custo                         ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
FZeraAcumuladores(3,3) 
Return(Nil)

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณfImpFil   บAutor  ณMauricio MR         บ Data ณ  04/05/10   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ Imprime Filial										      บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ GPER050			                                          บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function fImpFil()
Local lImpDarf	 := ExistBlock( "IMPDARF",.F.,.T. )//variavel p/ PE "IMPDARF" 

_nTipo:=2
//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Verifica se Acumulador de Filial > 0                         ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
If FTotAcumuladores(2,2) == 0 
	Return(Nil)
Endif

If !lGeraTitulo // GPEM650 nใo apresenta esta tela em seu processamento.
	If lImpDarf
		ExecBlock("IMPDARF",.F.,.F.)
	EndIf
EndIf

If lImpRelato
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Imprime total da filial                                      ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	fImprime(2)  
ElseIf lGeraTitulo .And. lAgrupFil
	fGravTit( cFilAnterior, , , aFolIR[2]+aAdiIR[2]+aFerIR[2]+a13IR[2] )
EndIf
//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Zera Acumuladores de Filial                                  ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
FZeraAcumuladores(2,2) 
Return(Nil)

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณfImpEmp   บAutor  ณMauricio MR         บ Data ณ  04/05/10   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ Imprime Total da Empresa									  บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ GPER050			                                          บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function fImpEmp()
_nTipo := 1

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Verifica se Acumulador Geral > 0                             ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
If FTotAcumuladores(1,1) == 0  
	Return(Nil)
Endif

If lImpRelato
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Imprime Acumulador Geral                                     ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	fImprime(1) // 
EndIf

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Zera Acumuladores Geral                                      ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
FZeraAcumuladores(1,1) 
Return(Nil)

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณfImprime  บAutor  ณMauricio MR         บ Data ณ  04/05/10   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณImprime Totais Gerais nTipo: 								  บฑฑ
ฑฑบ          ณ 4-Funcionario, 3-Centro de Custo, 2-Filial, 1- Empresa     บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ GPER050			                                          บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function fImprime(nTipo)
Local nTotLine := 0
_nTipo := nTipo

If nTipImp == 1 .And. nTpImpre == 1
	oSecCab:Cell(nRA_FILIAL):SetValue((cAliasSRA)->RA_FILIAL)
	oSecCab:Cell(nRA_CC    ):SetValue((cAliasSRA)->RA_CC)
	oSecCab:Cell(nRA_MAT   ):SetValue((cAliasSRA)->RA_MAT)
	oSecCab:Cell(nRA_NOME  ):SetValue((cAliasSRA)->RA_NOME)

	oSection1:Cell(nNFL_LCR_BS):SetValue(aFolBas[_nTipo])
	oSection1:Cell(nNFL_LCR_IR):SetValue(aFolIR [_nTipo])
	oSection1:Cell(nNADIAN_BS ):SetValue(aAdiBas[_nTipo])
	oSection1:Cell(nNADIAN_IR ):SetValue(aAdiIR [_nTipo])
	oSection1:Cell(nNFER_BS   ):SetValue(aFerBas[_nTipo])
	oSection1:Cell(nNFER_IR   ):SetValue(aFerIR [_nTipo])
	oSection1:Cell(nN13SAL_BS ):SetValue(a13Bas [_nTipo])
	oSection1:Cell(nN13SAL_IR ):SetValue(a13IR  [_nTipo])
	oSection1:Cell(nNPLR_BS   ):SetValue(aPLRBas[_nTipo])
	oSection1:Cell(nNPLR_IR   ):SetValue(aPLRIR [_nTipo])
	oSection1:Cell(nNTOTAIS_BS):SetValue(aFolBas[_nTipo] + aAdiBas[_nTipo] + aFerBas[_nTipo] + a13Bas[_nTipo] + aPLRBas[_nTipo])
	oSection1:Cell(nNTOTAIS_IR):SetValue(aFolIR [_nTipo] + aAdiIR [_nTipo] + aFerIR [_nTipo] + a13IR [_nTipo] + aPLRIR[_nTipo])
	If nTipo == 4
		If cSinAna == 'S'
			oSecCab:Hide()
			oSection1:Hide()
		EndIf
		nTotLine := oSecCab:report():row() //aterado para row() a pedido do Artur Fucher(Frame), nlinecount nao tava alimentando corretamente
		oSecCab:PrintLine()
		If cSinAna == 'S' .Or. ( oReport:nDevice == 4 ) .Or. oSecCab:report():row() <> nTotLine //S๓ imprime detalhe se tiver impresso cabe็alho
			oSection1:PrintLine()
		EndIf
	EndIf
EndIf
Return(Nil)

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบFunction  ณRetVerPro บAutor  ณMicrosiga           บ Data ณ  12/31/13   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณCarrega verbas que serao usadas no processamento, asssim    บฑฑ
ฑฑบ          ณevita processamento desnecessario                           บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ AP                                                         บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function RetVerPro(aVerba, cFilSRV)
Local lRetorno := .F.

If FP_CODFOL(@aCodFol, cFilSRV)
	aAdd(aVerba, {aCodFol[0010][1]}) //Base IR Adiantamento
	aAdd(aVerba, {aCodFol[0009][1]}) //IR Adiantamento
	aAdd(aVerba, {aCodFol[0015][1]}) //Base IR Folha
	aAdd(aVerba, {aCodFol[0016][1]}) //Base IR Ferias
	aAdd(aVerba, {aCodFol[0027][1]}) //Base IR 13a Salแrio
	aAdd(aVerba, {aCodFol[0066][1]}) //IR Folha
	aAdd(aVerba, {aCodFol[0067][1]}) //IR Ferias
	aAdd(aVerba, {aCodFol[0071][1]}) //IR 13a Salแrio
	aAdd(aVerba, {aCodFol[0100][1]}) //Dif. Base IR F้rias
	aAdd(aVerba, {aCodFol[0101][1]}) //Dif. IR Ferias
	aAdd(aVerba, {aCodFol[0659][1]}) //Vlr Compensa็ใo de IR
	aAdd(aVerba, {aCodFol[0974][1]}) //Base IR RRA
	aAdd(aVerba, {aCodFol[0978][1]}) //IR RRA
	aAdd(aVerba, {aCodFol[0979][1]}) //Base IR 13o Salario RRA
	aAdd(aVerba, {aCodFol[0983][1]}) //IR RRA 13o Salario
	aAdd(aVerba, {aCodFol[0835][1]}) //Base IR PLR
	aAdd(aVerba, {aCodFol[0152][1]}) //IR PLR
	aAdd(aVerba, {aCodFol[0106][1]}) //Base IR Mes Anterior
	aAdd(aVerba, {aCodFol[0107][1]}) //IR M๊s Anterior
	lRetorno := .T.
	cVerbaSql := fTrataVer(aVerba)
Endif

Return(lRetorno)

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบFunction  ณProcMenAcuบAutor  ณMicrosiga           บ Data ณ  23/01/14   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณProcessa verbas nas tabelas SRC e SRD                       บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ AP                                                         บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function ProcMovime(aPerAberto, aPerFechado, aVerba)
Local nVerba		:= 1
Local nTransf		:= 0
Local nLenaTransf	:= Len(aTransf)
Local lContinua		:= .T.
Local lRegCaixa		:= .F. 
Local aVerbasFunc	:= {}

cProcesso   := (cAliasSRA)->RA_PROCES

If nLenaTransf > 0
	For nTransf := 1 to nLenaTransf
		If aTransf[nTransf, 07] > dDataAte .and. !Empty(aTransf[nTransf, 14])
			cProcesso := aTransf[nTransf, 14]
		EndIf
		// Para gera็ใo de tํt. de IR, verifica se existe pgto efetuado no m๊s
		// seguinte do calculo, caso tenha ocorrido transferencia de processo
		If !Empty(aTransf[nTransf, 14]) .and. lGeraTitulo .and. Left(cVerbas,3) == "003" .and. ChkDtPag(aTransf[nTransf, 14])
			cProcesso := aTransf[nTransf, 14]
		EndIf
	Next nTransf 
EndIf
//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Processa movimento SRC/SRD se exister periodo                ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
If aScan(aPerAberto , {|x| x[7] == cProcesso }) == 0 .And. ;
   aScan(aPerFechado, {|x| x[7] == cProcesso }) == 0
	Return()
EndIf

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Carrega todas verbas do funcionario para processamento        ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
aVerbasFunc := RetornaVerbasFunc((cAliasSRA)->RA_FILIAL	,;	//-01 Filial
									(cAliasSRA)->RA_MAT		,;	//-02 Matricula
									''				,;	//-03 Centro de Custo
									''				,;	//-04 Roteiro
									cVerbaSql		,;	//-05 Verbas
									aPerAberto		,;	//-06 Periodo Aberto
									aPerFechado		,;	//-07 Periodo Fechado
									Nil			    ,;	//-08 Semana
									Nil				,;	//-09
									Nil				,;	//-09
									Nil				,;	//-09
									Nil				,;	//-09
									"C"				)	//-09

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Consiste controle de acessos								 ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
If (!Eval(cAcessaSRC)) .Or. (!Eval(cAcessaSRD))
	Return()
EndIf

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ aVerbasFunc                                                   ณ
//ณ 01 Filial                                                     ณ
//ณ 02 Matricula                                                  ณ
//ณ 03 PD                                                         ณ
//ณ 04 Tipo 1                                                     ณ
//ณ 05 QtdSem                                                     ณ
//ณ 06 Horas                                                      ณ
//ณ 07 Valor                                                      ณ
//ณ 08 Semana                                                     ณ
//ณ 09 Parcela                                                    ณ
//ณ 10 Periodo                                                    ณ
//ณ 11 Roteiro                                                    ณ
//ณ 12 CC                                                         ณ
//ณ 13 DataPgt                                                    ณ
//ณ 14 DataArq                                                    ณ
//ณ 15 Sequencia                                                  ณ
//ณ 16 NumId                                                      ณ
//ณ 17 Tipo 2                                                     ณ
//ณ 18 Nulo                                                       ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
For nVerba := 1 To Len(aVerbasFunc)

	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Verifica as transferencias para somar as verbas              ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	lContinua 	:= .T.
	If nLenaTransf > 0
		For nTransf := nLenaTransf To 1 Step -1
			lRegCaixa := MesAno(aVerbasFunc[nVerba][13]) > aVerbasFunc[nVerba][10] // verifica se ้ regime caixa
			If aVerbasFunc[nVerba][13] <= aTransf[nTransf, 07] .Or. (aVerbasFunc[nVerba][13] >= aTransf[nTransf, 07] .and. MesAno(aVerbasFunc[nVerba][13]) > aVerbasFunc[nVerba][10] .and. !lRegCaixa)
				lContinua := (aTransf[nTransf, 08] + aTransf[nTransf, 09] )  == ( (cAliasSRA)->(RA_FILIAL+RA_MAT) )
			ElseIf aVerbasFunc[nVerba][13] >= aTransf[nTransf, 07]
				lContinua := (aTransf[nTransf, 10] + aTransf[nTransf, 11] )  == ( (cAliasSRA)->(RA_FILIAL+RA_MAT) )
				If aVerbasFunc[nVerba][3] == aCodFol[106,1] .or. aVerbasFunc[nVerba][3] == aCodFol[107,1]
					lContinua := .F.
				EndIf
			EndIf
			// ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ 
			// Quando o funcionแrio tem mais de uma transferencia dentro do mes,
			// a busca come็a da ultima at้ primeira. Portanto, se jแ encontrar,
			// a ultima, deve sair do loop.
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
			If lContinua
				Exit
			Endif
		Next nTransf
	EndIf

	If ( dDataDe <= aVerbasFunc[nVerba][13] .And. dDataAte >= aVerbasFunc[nVerba][13] ) .And. lContinua
	
		//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
		//ณ Adiantamento de Salario                                      ณ
		//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
		SmMovAdi(aVerbasFunc[nVerba])
		
		//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
		//ณ Folha de Pagamento                                           ณ
		//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
		SmMovFol(aVerbasFunc[nVerba])
				
		If !lPLR
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ Ferias                                                       ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
			SmMovFer(aVerbasFunc[nVerba])	
			
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ 13ง Salario                                                  ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
			SmMov13S(aVerbasFunc[nVerba])						
	
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ RRA                                                          ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
			SmMovRRA(aVerbasFunc[nVerba])
		EndIf
	EndIf
Next nVerba

Return()

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบFunction  ณFolAdi    บAutor  ณMicrosiga           บ Data ณ  23/01/14   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณSoma verba de adiantamento                                  บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ AP                                                         บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function SmMovAdi(aVerba)

If !lTitRRA .And. !lPLR 
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ IR do Adiantamento											 ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	If aVerba[03]  == aCodFol[0009][1] //IR do Adiantamento (Cod.Base para demonst.Folha)
		fSoma("ADIIR", aVerba[07], aVerba[03], aVerba[13],.T.,aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11])        
	EndIf
	
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Base IR do Adiantamento                                      ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	If aVerba[03] == aCodFol[0010][1] .And. aAdiIr[4] > 0//Base do I.R. no Adiantamento
		fSoma("ADIBAS", aVerba[07], aVerba[03], aVerba[13],.T.,aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11])                            
	EndIf
EndIf
Return()

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบFunction  ณFolAdi    บAutor  ณMicrosiga           บ Data ณ  23/01/14   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณSoma verba de folha                                         บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ AP                                                         บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function SmMovFol(aVerba)

If aVerba[17] $ "C*I*G*R" .And. !lPLR .And. !lTitRRA
 
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ IR Folha                                                     ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	If aVerba[03] == aCodFol[0066][1] //Desconto do Imposto de Renda                           
		fSoma("FOLIR" , aVerba[07]     , aVerba[03], aVerba[13], .T., aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11],aVerba[10])
		lIRMesAnt := .F.
	EndIf
	 
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ IR Compensacao pago a maior                                  ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	If aVerba[03] == aCodFol[0659][1] //Vlr Compesacao de IR                                   
		fSoma("FOLIR" , aVerba[07]*(-1), aVerba[03], aVerba[13], .T., aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11],aVerba[10])
	EndIf
	 
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Base IR Folha                                                ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	If aVerba[03] == aCodFol[0015][1] .And. aFolIr[4] > 0  //Base Imposto de Renda                                  
		fSoma("FOLBAS", aVerba[07]     , aVerba[03], aVerba[13], .T., aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11],aVerba[10])
	EndIf
EndIf

If aVerba[17] $ "C*I*G*F" .And. !lPLR .And. lIRMesAnt
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Base IR M๊s Anterior                                         ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	If aVerba[03] == aCodFol[0106][1]
		fSoma("FOLBAS" , aVerba[07], aVerba[03], aVerba[13], .T., aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11],aVerba[10])
	EndIf
	 
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ IR M๊s Anterior                                              ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	If aVerba[03] == aCodFol[0107][1]
		fSoma("FOLIR" , aVerba[07], aVerba[03], aVerba[13], .T., aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11],aVerba[10])
	EndIf
EndIf

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Distribuicao de Lucros                                       ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
If aVerba[17] $ "C*I*G*A"  .And. ( lPLR .or. nTpImpre == 1 ) .And. !lTitRRA
 
 	If lPLR
		//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
		//ณ IR Distribuicao de Lucros                                    ณ
		//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
		If aVerba[03] == aCodFol[0152][1] //Imposto Renda da Verba Distribuicao de Lucro           
			fSoma("FOLIR" , aVerba[07], aVerba[03], aVerba[13], .T., aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11],aVerba[10])
		EndIf
		 
		//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
		//ณ Base IR Distribuicao de Lucros                               ณ
		//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู	
		If aVerba[03] == aCodFol[0835][1] //Verba de Distribuicao de Lucro                         
			fSoma("FOLBAS", aVerba[07], aVerba[03], aVerba[13], .T., aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11],aVerba[10])
		EndIf
	Else //Relat๓rio DIRF
		//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
		//ณ IR Distribuicao de Lucros                                    ณ
		//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
		If aVerba[03] == aCodFol[0152][1] //Imposto Renda da Verba Distribuicao de Lucro           
			fSoma("PLRIR" , aVerba[07], aVerba[03], aVerba[13], .T., aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11],aVerba[10])
		EndIf
		 
		//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
		//ณ Base IR Distribuicao de Lucros                               ณ
		//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู	
		If aVerba[03] == aCodFol[0835][1] //Verba de Distribuicao de Lucro                         
			fSoma("PLRBAS", aVerba[07], aVerba[03], aVerba[13], .T., aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11],aVerba[10])
		EndIf	
	EndIf
EndIf

Return()

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบFunction  ณFolAdi    บAutor  ณMicrosiga           บ Data ณ  23/01/14   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณSoma verba de ferias                                        บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ AP                                                         บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function SmMovFer(aVerba)	
//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ IR Ferias ou Dif. IR Ferias                                  ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
If ( aVerba[03] == aCodFol[067][1] .And. aVerba[17] $ "K*I*G*R" ) .Or. ; //Desconto do Imposto de Renda Ferias                    
   ( aVerba[03] == aCodFol[101][1] .And. aVerba[17] #  "R" )		//Diferenca de I.R. Ferias                               
	fSoma("FERIR" , aVerba[07], aVerba[03], aVerba[13], .T., aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11])
EndIf
 
//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Base IR Ferias ou Dif.Base IR Ferias                         ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
If (( aVerba[03] == aCodFol[016][1] .And. aVerba[17] $ "K*I*G*R" ) .Or.;	//Base Imposto de Renda Ferias                           
    ( aVerba[03] == aCodFol[100][1] .And. aVerba[17] #  "R" ))  	//Diferenca de Base I.R. Ferias                          
	fSoma("FERBAS", aVerba[07], aVerba[03], aVerba[13], .T., aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11])
EndIf
 
Return()

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบFunction  ณFolAdi    บAutor  ณMicrosiga           บ Data ณ  23/01/14   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณSoma verba de 13o salario                                   บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ AP                                                         บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function SmMov13S(aVerba)
//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ IR 13 Salario                                                ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
If aVerba[03] == aCodFol[0071][1] //Imposto de Renda sobre 13o.Salario                     
	fSoma("13IR" ,aVerba[07], aVerba[03], aVerba[13], .T., aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11])
EndIf
 
//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Base IR 13 Salario                                           ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
If aVerba[03] == aCodFol[0027][1] .And. a13Ir[4] > 0 //Base I.R. no 13o.Salario                               
	fSoma("13BAS", aVerba[07], aVerba[03], aVerba[13], .T., aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11])
EndIf

Return()

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบFunction  ณSmMovRRA  บAutor  ณMicrosiga           บ Data ณ  23/01/14   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณSoma verba de RRA                                           บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ AP                                                         บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function SmMovRRA(aVerba)

 If !lTitRRA
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ RRA - IR                                                     ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
	If aVerba[03] == aCodFol[0978][1] //IR RRA                                                                      
		fSoma("FOLIR" ,aVerba[07], aVerba[03], aVerba[13], .T., aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11])
	EndIf
	
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ RRA - BASE IR                                                ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
	If aVerba[03] == aCodFol[0974][1] //Base IR RRA                                                           
		fSoma("FOLBAS" ,aVerba[07], aVerba[03], aVerba[13], .T., aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11])
	EndIf
	
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ RRA - IR 13 Salario                                          ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
	If aVerba[03] == aCodFol[0979][1] //Base IR 13o.RRA                                        
		fSoma("13IR" ,aVerba[07], aVerba[03], aVerba[13], .T., aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11])
	EndIf
	
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ RRA - IR 13 Salario                                          ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
	If aVerba[03] == aCodFol[0983][1] //IR RRA 13o                                             
		fSoma("13IR" ,aVerba[07], aVerba[03], aVerba[13], .T., aVerba[17], aVerba[12]+aVerba[21]+aVerba[22], aVerba[08], aVerba[11])
	EndIf
EndIf	
Return()

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบFunction  ณFolAdi    บAutor  ณMicrosiga           บ Data ณ  23/01/14   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ Procura no SRG Funcionarios Demitidos                      บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ AP                                                         บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function ProcRescisao() 
Local nX 			:= 1
Local aRecnoSRG	:= {}
Local aRecnoSRGD 	:= {}
Local nPosAbert	:= 0
//Local nPosFech	:= 0
Local aAuxPer 	:= {}
Local cRotRes	:= fGetCalcRot("4")

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Consiste controle de acessos								 ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
If !Eval(cAcessaSRG)
	Return()
EndIf

While !Eof() .And. (cAliasSRA)->(RA_FILIAL+RA_MAT) == SRG->(RG_FILIAL+RG_MAT)
	If SRG->RG_EFETIVA = "S" .And. (SRG->RG_DATAHOM >= dDataDe .And. SRG->RG_DATAHOM <= dDataAte )

		// Se periodo foi integrado, nใo verifica os registros de Rescisao
		// pois estes ja foram integrados a Folha
		fRetPerComp( SubStr( SRG->RG_PERIODO, 5 ), SubStr( SRG->RG_PERIODO, 1, 4) , xFilial('RCH', (cAliasSRA)->RA_FILIAL), SRG->RG_PROCES, cRotRes, NIL , NIL , @aAuxPer)
		nPosAbert := aScan(aAuxPer,{|x| x[1] + x[2] + x[8] + x[7]  == SRG->(RG_PERIODO + RG_SEMANA + RG_ROTEIR + RG_PROCES) }) 
		If nPosAbert > 0 .AND. !Empty(aAuxPer[nPosAbert][11])
			SRG->(dbSkip())
		 	Loop
		Endif
	
		//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
		//ณ Monta array com dados da rescisao                			 ณ
		//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
		aAdd(aRecnoSRG,{SRG->(RG_FILIAL+RG_MAT), SRR->RR_DATAPAG, SRG->RG_DATAHOM, SRG->RG_DATADEM, SRG->(RECNO())})
		
		dbSelectArea( "SRR" )
		dbSetOrder(1)
		If dbSeek( (cAliasSRA)->(RA_FILIAL+RA_MAT) + "R" + DtoS(SRG->RG_DTGERAR))
			While SRR->(!Eof()) .And. (cAliasSRA)->(RA_FILIAL+RA_MAT) + "R" + DtoC(SRG->RG_DTGERAR) == ;
							          SRR->(RR_FILIAL+RR_MAT) + "R" + DtoC(SRR->RR_DATA)
				
				//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
				//ณ Folha de Pagamento                                           ณ
				//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
 				If !lPLR
					If !lTitRRA

						//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
						//ณ IR Folha                                                     ณ
						//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
						If SRR->RR_PD == aCodFol[0066][1]
							fSoma("FOLIR", SRR->RR_VALOR, SRR->RR_PD, SRR->RR_DATAPAG, .T., SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
						EndIf
		
						//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
						//ณ Base IR Folha                                                ณ
						//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
						If SRR->RR_PD == aCodFol[0015][1] .And. aFolIr[4] > 0
							fSoma("FOLBAS", SRR->RR_VALOR, SRR->RR_PD, SRR->RR_DATAPAG, .T., SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
						EndIf                                                             
					Else

						//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
						//ณ RRA - IR                                                     ณ
						//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
						If SRR->RR_PD == aCodFol[0978][1] //IR RRA                                                                      
							fSoma("FOLIR" , SRR->RR_VALOR, SRR->RR_PD, SRR->RR_DATAPAG, .T., SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
						EndIf
						
						//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
						//ณ RRA - BASE IR                                                ณ
						//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
						If SRR->RR_PD == aCodFol[0974][1] //Base IR RRA                                                           
							fSoma("FOLBAS" , SRR->RR_VALOR, SRR->RR_PD, SRR->RR_DATAPAG, .T., SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
						EndIf
						
						//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
						//ณ RRA - IR 13 Salario                                          ณ
						//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
						If SRR->RR_PD == aCodFol[0979][1] //Base IR 13o.RRA                                        
							fSoma("13IR"  , SRR->RR_VALOR, SRR->RR_PD, SRR->RR_DATAPAG, .T., SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
						EndIf
						
						//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
						//ณ RRA - IR 13 Salario                                          ณ
						//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
						If SRR->RR_PD == aCodFol[0983][1] //IR RRA 13o                                             
							fSoma("13IR"  , SRR->RR_VALOR, SRR->RR_PD, SRR->RR_DATAPAG, .T., SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
						EndIf
					EndIf
				EndIf

				If !lTitRRA
					If lPLR
						//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
						//ณ Distribuicao de Lucros                                       ณ
						//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
						// IR Distribuicao de Lucros
						If SRR->RR_PD == aCodFol[152][1] .and. SRR->RR_TIPO2 # "A"
							fSoma("FOLIR",SRR->RR_VALOR,SRR->RR_PD,SRR->RR_DATAPAG,.T.,SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
						Endif
						// Base IR Distribuicao de Lucros
						If SRR->RR_PD == aCodFol[151][1] .And. aFolIr[4] > 0 .and. SRR->RR_TIPO2 # "A"
							fSoma("FOLBAS",SRR->RR_VALOR,SRR->RR_PD,SRR->RR_DATAPAG,.T.,SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
						Endif
					Else
						//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
						//ณ Ferias                                                       ณ
						//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
		 
						//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
						//ณ IR Ferias ou Dif.IR Ferias                                   ณ
						//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
						If (SRR->RR_PD == aCodFol[0067][1] .Or. SRR->RR_PD == aCodFol[101,1]) .and. SRR->RR_DATAPAG == SRG->RG_DATAHOM
							fSoma("FERIR", SRR->RR_VALOR, SRR->RR_PD, SRR->RR_DATAPAG, .T., SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
						EndIf
		 
						//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
						//ณ Base IR Ferias ou Dif.Base IR Ferias                         ณ
						//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
						If (SRR->RR_PD == aCodFol[0016][1] .Or. SRR->RR_PD == aCodFol[100,1] ) .And. aFerIr[4] > 0 .and. SRR->RR_DATAPAG == SRG->RG_DATAHOM
							fSoma("FERBAS", SRR->RR_VALOR, SRR->RR_PD, SRR->RR_DATAPAG, .T., SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
						EndIf
						
						//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
						//ณ 13ง Salario                                                  ณ
						//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู

						//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
						//ณ IR 13 Salario                                                ณ
						//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
						If SRR->RR_PD == aCodFol[0071][1]
							fSoma("13IR", SRR->RR_VALOR, SRR->RR_PD, SRR->RR_DATAPAG, .T., SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
						EndIf
		
						//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
						//ณ Base IR 13 Salario                                           ณ
						//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
						If SRR->RR_PD == aCodFol[0027][1] .And.a13Ir[4] > 0
							fSoma("13BAS", SRR->RR_VALOR, SRR->RR_PD, SRR->RR_DATAPAG, .T., SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
						EndIf
					EndIf
				EndIf			
				SRR->(dbSkip())
			EndDo
		EndIf
	EndIf
	dbSelectArea("SRG")
	SRG->(dbSkip())
EndDo

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Define as rescisoes que devem ter o Ir abatido.                  ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
For nX := 1 to Len(aRecnoSRG)
	dbSelectArea("SRG")
	dbGoTo(aRecnoSRG[nX][5])
	SRG->(dbSkip(-1))
	If	SRG->(RG_FILIAL+RG_MAT) == aRecnoSRG[nx][1] .And. ;
		MesAno(SRG->RG_DTGERAR) == MesAno(aRecnoSRG[nX][2]) .And. ;
		MesAno(SRG->RG_DTGERAR) == MesAno(SRG->RG_DATADEM)  .And. ;
		!SRG->(BoF())
		aAdd(aRecnoSRGD, {SRG->(RG_FILIAL+RG_MAT), SRG->RG_DTGERAR, SRG->RG_DATAHOM, SRG->RG_DATADEM, SRG->(Recno())})
	EndIf
Next nX

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Ajusta os valores de ir de rescisoes complementares dentro do mesณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
dbSelectArea( "SRR" )
lRecalcIR := .F.
For nX := 1 to Len(aRecnoSRGD)
	If !lPLR
		If !lTitRRA

			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ Folha de Pagamento                                           ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
		 
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ IR Folha                                                     ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
			If SRR->(dbSeek( aRecnoSRGD[nx,1] + "R" + DtoS(aRecnoSRGD[nx,2]) + aCodFol[66][1] )) 
				lRecalcIR := .T.
				fSoma("FOLIR",SRR->RR_VALOR*(-1),SRR->RR_PD,SRR->RR_DATAPAG,.T.,SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
			Endif
		 
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ Base IR Folha                                                ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
			If SRR->(dbSeek( aRecnoSRGD[nx,1] + "R" + DtoS(aRecnoSRGD[nx,2]) + aCodFol[15][1] )) 
				fSoma("FOLBAS",SRR->RR_VALOR*(-1),SRR->RR_PD,SRR->RR_DATAPAG,.T.,SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
			Endif
		Else
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ RRA - IR                                                     ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
			If SRR->(dbSeek( aRecnoSRGD[nx,1] + "R" + DtoS(aRecnoSRGD[nx,2]) + aCodFol[0978][1] )) //IR RRA                                                                      
				fSoma("FOLIR" , SRR->RR_VALOR, SRR->RR_PD, SRR->RR_DATAPAG, .T., SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
			EndIf
			
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ RRA - BASE IR                                                ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
			If SRR->(dbSeek( aRecnoSRGD[nx,1] + "R" + DtoS(aRecnoSRGD[nx,2]) + aCodFol[0974][1] )) //Base IR RRA                                                           
				fSoma("FOLBAS" , SRR->RR_VALOR, SRR->RR_PD, SRR->RR_DATAPAG, .T., SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
			EndIf
			
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ RRA - IR 13 Salario                                          ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
			If SRR->(dbSeek( aRecnoSRGD[nx,1] + "R" + DtoS(aRecnoSRGD[nx,2]) + aCodFol[0979][1] )) //Base IR 13o.RRA                                        
				fSoma("13IR"  , SRR->RR_VALOR, SRR->RR_PD, SRR->RR_DATAPAG, .T., SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
			EndIf
			
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ RRA - IR 13 Salario                                          ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู				
			If SRR->(dbSeek( aRecnoSRGD[nx,1] + "R" + DtoS(aRecnoSRGD[nx,2]) + aCodFol[0983][1] )) //IR RRA 13o                                             
				fSoma("13IR"  , SRR->RR_VALOR, SRR->RR_PD, SRR->RR_DATAPAG, .T., SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
			EndIf		
		EndIf
	EndIf
	
	If !lTitRRA
		If lPLR
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ Distribuicao de Lucros                                       ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
			// IR Distribuicao de Lucros
			If dbSeek( aRecnoSRGD[nx,1] + "R" + DtoS(aRecnoSRGD[nx,2]) + aCodFol[152][1] ) .And. aFolIr[4] > 0
				fSoma("FOLIR",SRR->RR_VALOR*(-1),SRR->RR_PD,SRR->RR_DATAPAG,.T.,SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
			Endif
			// Base IR Distribuicao de Lucros
			If dbSeek( aRecnoSRGD[nx,1] + "R" + DtoS(aRecnoSRGD[nx,2]) + aCodFol[151][1] ) .And. aFolBas[4] > 0
				fSoma("FOLBAS",SRR->RR_VALOR*(-1),SRR->RR_PD,SRR->RR_DATAPAG,.T.,SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
			Endif
		Else

			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ Ferias                                                       ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
		 
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ IR Ferias                                                    ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
			If SRR->(dbSeek( aRecnoSRGD[nx,1] + "R" + DtoS(aRecnoSRGD[nx,2]) + aCodFol[67][1] )) 
				fSoma("FERIR",SRR->RR_VALOR*(-1),SRR->RR_PD,SRR->RR_DATAPAG,.T.,SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
			Endif
		 
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ Dif.IR Ferias                                                ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
			If SRR->(dbSeek( aRecnoSRGD[nx,1] + "R" + DtoS(aRecnoSRGD[nx,2]) + aCodFol[101][1] ))
				fSoma("FERIR",SRR->RR_VALOR*(-1),SRR->RR_PD,SRR->RR_DATAPAG,.T.,SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
			Endif
		 
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ Base IR Ferias                                               ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
			If SRR->(dbSeek( aRecnoSRGD[nx,1] + "R" + DtoS(aRecnoSRGD[nx,2]) + aCodFol[16][1] )) 
				fSoma("FERBAS",SRR->RR_VALOR*(-1),SRR->RR_PD,SRR->RR_DATAPAG,.T.,SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
			Endif
		 
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ Dif.Base IR Ferias                                           ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
			If SRR->(dbSeek( aRecnoSRGD[nx,1] + "R" + DtoS(aRecnoSRGD[nx,2]) + aCodFol[100][1] ))
				fSoma("FERBAS",SRR->RR_VALOR*(-1),SRR->RR_PD,SRR->RR_DATAPAG,.T.,SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
			Endif
		
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ 13ง Salario                                                  ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
		
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ IR 13 Salario                                                ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
			If SRR->(dbSeek( aRecnoSRGD[nx,1] + "R" + DtoS(aRecnoSRGD[nx,2]) + aCodFol[71][1] )) 
				fSoma("13IR",SRR->RR_VALOR*(-1),SRR->RR_PD,SRR->RR_DATAPAG,.T.,SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
			Endif 
			
			//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
			//ณ Base IR 13 Salario                                           ณ
			//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู		
			If SRR->(dbSeek( aRecnoSRGD[nx,1] + "R" + DtoS(aRecnoSRGD[nx,2]) + aCodFol[27][1] )) 
				fSoma("13BAS",SRR->RR_VALOR*(-1),SRR->RR_PD,SRR->RR_DATAPAG,.T.,SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
			Endif
		EndIf
	EndIf
Next nX

Return()

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบFunction  ณFolAdi    บAutor  ณMicrosiga           บ Data ณ  23/01/14   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณ Procura no SRH Funcionarios em Ferias                      บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ AP                                                         บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function ProcFerias()
Local dDtBusFer 	:= CtoD("")
Local lSegRecibo	:= .F.


//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Tratamento de transferencias                                     ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
Local cDataRecib	:= ""
Local lExitLoop		:= .F.
Local nTransf		:= 0
Local nLenaTransf	:= 0	
Local aAuxPer		:= {}
Local cRotFer		:= fGetCalcRot("3") 
Local nPosAbert		:= 0
	
dbSelectArea( "SRH" )
If SRH->(!dbSeek( (cAliasSRA)->(RA_FILIAL+RA_MAT )))
	Return()
EndIf

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Consiste controle de acessos								 ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
If !Eval(cAcessaSRH)
	Return()
EndIf

If lTitRRA
	Return()
EndIf

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Carrega as Transferencias para o AnoMes do DARF              ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู		
While SRH->(!Eof()) .And. (cAliasSRA)->(RA_FILIAL+RA_MAT) == SRH->(RH_FILIAL+RH_MAT)
	
	fRetPerComp( SubStr( SRH->RH_PERIODO, 5 ), SubStr( SRH->RH_PERIODO, 1, 4) , xFilial('RCH', (cAliasSRA)->RA_FILIAL), SRH->RH_PROCES, cRotFer, NIL , NIL , @aAuxPer)
	nPosAbert := aScan(aAuxPer,{|x| x[1] + x[2] + x[8] + x[7]  == SRH->(RH_PERIODO + RH_NPAGTO + RH_ROTEIR + RH_PROCES) }) 
	If nPosAbert > 0 .AND. !Empty(aAuxPer[nPosAbert][11])
		SRH->(dbSkip())
	 	Loop
	Endif

	
	dDtBusFer := fDtBusFer() 
	If Type('dDtBusFer') # 'D'
		dDtBusFer := SRH->RH_DATAINI
	EndIf
	If (SRH->RH_DTRECIB >= dDataDe .And. SRH->RH_DTRECIB <= dDataAte )
	  					              
		nLenaTransf	:= Len(aTransf)
		cDataRecib	:= Dtos(SRH->RH_DTRECIB)
		lExitLoop	:= .F.
		For nTransf := nLenaTransf To 1 Step -1 
        	If cDataRecib >= Dtos(aTransf[nTransf, 07])
            	If !( (aTransf[nTransf, 10] + aTransf[nTransf, 11] )  == ( (cAliasSRA)->(RA_FILIAL+RA_MAT) ) )
                	lExitLoop	:= .T.
				Endif     
				Exit
			ElseIf nTransf == 1
				If !( (aTransf[nTransf, 08] + aTransf[nTransf, 09] )  == ( (cAliasSRA)->(RA_FILIAL+RA_MAT) ) )
					lExitLoop	:= .T.
				Endif     
				Exit
			EndIf
		Next nTransf  
                
		//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
		//ณ Verifica se desconsidera os movimentos de ferias devido aos  ณ
		//ณ dados serem resultado de uma tranferencia                    |
		//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
        If lExitLoop 
        	SRH->(dbSkip())
            Loop
		Endif   
		
		dbSelectArea( "SRR" )
		dbSetOrder(1)
		If SRR->(dbSeek( (cAliasSRA)->(RA_FILIAL+RA_MAT) + "F" + DtoS(dDtBusFer) + aCodfol[067,1] ))
			fSoma("FERIR", SRR->RR_VALOR, SRR->RR_PD, SRH->RH_DTRECIB, lSegRecibo, SRR->RR_TIPO2, SRR->RR_CC, SRR->RR_SEMANA, SRR->RR_ROTEIR )
			If SRR->(dbSeek( (cAliasSRA)->(RA_FILIAL+RA_MAT) + "F" + DtoS(dDtBusFer) + aCodfol[101,1] ))
				fSoma("FERIR", SRR->RR_VALOR, SRR->RR_PD, SRH->RH_DTRECIB, lSegRecibo, SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
			EndIf
			If SRR->(dbSeek( (cAliasSRA)->(RA_FILIAL+RA_MAT) + "F" + DtoS(dDtBusFer) + aCodfol[016,1] )) .And.;
			   aFerIr[4] > 0 
				fSoma("FERBAS", SRR->RR_VALOR, SRR->RR_PD, SRH->RH_DTRECIB, lSegRecibo, SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
				If SRR->(dbSeek( (cAliasSRA)->(RA_FILIAL+RA_MAT) + "F" + DtoS(dDtBusFer) + aCodfol[100,1] ))
					fSoma("FERBAS", SRR->RR_VALOR, SRR->RR_PD, SRH->RH_DTRECIB, lSegRecibo, SRR->RR_TIPO2, SRR->RR_CC+SRR->RR_ITEM+SRR->RR_CLVL, SRR->RR_SEMANA, SRR->RR_ROTEIR )
				Endif
			Endif
			lSegRecibo := .T.
		Endif
	Endif
	dbSelectArea("SRH")
	SRH->(dbSkip())
EndDo

Return()

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑฺฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤฟฑฑ
ฑฑณFuno    ณfRadioPergณ Autor ณ Tania Bronzeri        ณ Data ณ04/09/2006ณฑฑ
ฑฑรฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤดฑฑ
ฑฑณDescrio ณ Monta dialogo para selecao com botoes de radio             ณฑฑ
ฑฑรฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤดฑฑ
ฑฑณ Uso      ณ                                                            ณฑฑ
ฑฑภฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤูฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function fRadioPerg(nOpcRadio)
Local nOpcAux		:= 0
Local oRadio		:= Nil
Local oDlg			:= Nil
Local oGroup		:= Nil
Local oFont			:= Nil
//Local nReg			:= Nil
Local aAdvSize		:= {}
Local aInfoAdvSize	:= {}
Local aObjSize		:= {}
Local aObjCoords	:= {}
Local aButtons		:= {}
Local bSet15		:= { || NIL }
Local bSet24		:= { || NIL }

nOpcAux   := nOpcRadio
nOpcRadio := 0

DEFINE FONT oFont NAME "Arial" SIZE 0,-11 BOLD

//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Monta as Dimensoes dos Objetos         					     ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
aAdvSize		:= MsAdvSize()
aAdvSize[5]		:= (aAdvSize[5]/100) * 60	//horizontal
aAdvSize[6]		:= (aAdvSize[6]/100) * 50	//Vertical
aInfoAdvSize	:= { aAdvSize[1] , aAdvSize[2] , aAdvSize[3] , aAdvSize[4] , 0 , 0 }					 
aAdd( aObjCoords , { 000 , 000 , .T. , .T. } )
aObjSize		:= MsObjSize( aInfoAdvSize , aObjCoords )
aGdCoord		:= { (aObjSize[1,1]+3), (aObjSize[1,2]+5), (((aObjSize[1,3])/100)*60), (((aObjSize[1,4])/100)*50) }	//1,3 Vertical /1,4 Horizontal

DEFINE MSDIALOG oDlg TITLE OemToAnsi( STR0001 ) From aAdvSize[7],0 TO aAdvSize[6],aAdvSize[5] OF oMainWnd PIXEL

	@ aGdCoord[1]+5 , aGdCoord[2] GROUP oGroup TO (aGdCoord[3]/1.5),aGdCoord[4]+10 LABEL OemToAnsi(STR0040) OF oDlg PIXEL	//"Dirf Mensal / Darf"
	oGroup:oFont:=oFont
	         
	@ aGdCoord[1]+17 , aGdCoord[2]+25 RADIO oRadio VAR nOpcAux	ITEMS OemToAnsi(STR0038),OemToAnsi(STR0039)		;	//
										SIZE 150,010 OF oDlg PIXEL	//"Relatorio Dirf Mensal"###"Darf"
	
	bSet15		:= { || nOpcRadio := nOpcAux, oDlg:End() }
	bSet24		:= { || nOpcRadio := -1,      oDlg:End() }

ACTIVATE MSDIALOG oDlg CENTERED ON INIT EnchoiceBar( oDlg , bSet15 , bSet24 , NIL , aButtons )

Return( nOpcRadio )

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณProcesDARFบAutor  ณRH                  บ Data ณ  04/05/10   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณObtem as transferencias para tratamento de ferias			  บฑฑ
ฑฑบ          ณ                                                            บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ GPER050			                                          บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/
Static Function ProcesDarf(lEnd, cFiltro) 

Local cWhereSRA  := ""
Local cOrderSRA  := ""
Local cCamposSRA := ""
Local cValidFil	 := ""
Local nX		 := 0
Local aValidFil	 := StrToArray(fValidFil(),"/") //array com as filiais que o usuario possui acesso
Local cUserFilt	 := ""

Private aTransf	 := {}
Private cAcessaSRC 	:= &("{ || " + ChkRH("GPER050","SRC","2") + "}")
Private cAcessaSRD 	:= &("{ || " + ChkRH("GPER050","SRD","2") + "}")
Private cAcessaSRG 	:= &("{ || " + ChkRH("GPER050","SRG","2") + "}")
Private cAcessaSRH 	:= &("{ || " + ChkRH("GPER050","SRH","2") + "}")
Private lImpPre := .T.
SetPrvt("NVEZ,NLIDARF")

Default cFiltro := ""

Static cAliasSRA := ""
cAliasSRA := "QRYSRA"

If !lGeraTitulo
	cPerg := 'GPR050'
	If nTpImpre == 1
		cPerg := 'GP050R'
	EndIf
	Pergunte(cPerg, .F.)
	cFilDe       := mv_par01
	cFilAte      := mv_par02
	cCcDe        := mv_par03
	cCcAte       := mv_par04
	cMatDe       := mv_par05
	cMatAte      := mv_par06
	cNomDe       := mv_par07
	cNomAte      := mv_par08
	dDataDe      := mv_par09
	dDataAte     := mv_par10
	cSinAna      := Iif(mv_par11 == 1,"A","S")
ElseIf FunName() == "GPER060"
	Pergunte("GPR060", .F.)
	cCcDe        := mv_par03
	cCcAte       := mv_par04
	cNomDe       := Space(30)
	cNomAte      := Replicate("Z", 30)
	cDataRef	 := dToS(mv_par05)
	dDataDe 	 := cToD( "01/" + SubStr( cDataRef, 5, 2 ) + "/" + SubStr( cDataRef, 1, 4 ) )
	dDataAte     := cToD( StrZero( f_UltDia( dDataDe ), 2) + "/" + SubStr( cDataRef, 5, 2 ) + "/" + SubStr( cDataRef, 1, 4 ) )
	cSinAna      := "A"//Iif(mv_par11 == 1,"A","S")
Else//GPEM650
	Pergunte("GPM650", .F.)
	cCcDe        := mv_par03
	cCcAte       := mv_par04
	cMatDe       := mv_par05
	cMatAte      := mv_par06
	cNomDe       := Space(30)
	cNomAte      := Replicate("Z", 30)
	dDataDe      := mv_par07
	dDataAte     := mv_par08
	cSinAna      := "A"//Iif(mv_par11 == 1,"A","S")
EndIf
//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Define os periodos onde devem ser lidos os identificadores deณ
//ณ verbas de folha de pagamento e adiantamento de salario.      ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
If MesAno(dDataDe) <> MesAno(dDataAte) 
	If lImpRelato  
		Aviso(OemToAnsi(STR0020),OemToAnsi(STR0021), { "OK"} )	//"Aviso"###"As datas inicial e final devem estar dentro do mesmo m๊s e ano. Verifique."
	EndIf
	Return(Nil)
EndIf

If !Empty(cCentra) .And. nTpImpre != 1
	if ! (fInfo(@aInfo,cCentra))
		Aviso(OemToAnsi(STR0020),OemToAnsi(STR0064), { "OK"} )
		Return(Nil)
	endif	
Endif 



//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Cria indice para Relatorio de IR.                            ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
If nTpImpre == 1
	If nOrdem == 1
		cOrderSRA := "%RA_FILIAL, RA_MAT%"
	ElseIf nOrdem == 2
		cOrderSRA := "%RA_FILIAL, RA_CC, RA_MAT%" 
	ElseIf nOrdem == 3
		cOrderSRA := "%RA_FILIAL, RA_NOME ,RA_MAT%" 
	Endif
Else
	If nOrdem == 1
		cOrderSRA := Iif( Empty( cCentra ), "%RA_FILIAL, RA_CODRET, RA_MAT%", "%RA_CODRET, RA_FILIAL, RA_MAT%")
	ElseIf nOrdem == 2
		cOrderSRA := Iif( Empty( cCentra ), "%RA_FILIAL, RA_CODRET, RA_CC, RA_MAT%", "%RA_CODRET, RA_FILIAL, RA_CC, RA_MAT%") 
	ElseIf nOrdem == 3
		cOrderSRA := Iif( Empty( cCentra ), "%RA_FILIAL, RA_CODRET, RA_NOME, RA_MAT%", "%RA_CODRET, RA_FILIAL, RA_NOME ,RA_MAT%") 
	Endif
Endif

aFill(aFolBas, 0)
aFill(aAdiBas, 0)
aFill(aFerBas, 0)
aFill(a13Bas , 0)
aFill(aPLRBas, 0)
aFill(aFolIR , 0)
aFill(aAdiIR , 0)
aFill(aFerIR , 0)
aFill(a13IR  , 0)
aFill(aPLRIR , 0)

cFilAnterior 	:= Replicate("!", FWGETTAMFILIAL)
cFilQuebra      := Replicate("!", FWGETTAMFILIAL)
cCcAnt  		:= "!!!!!!!!!"

If nTipImp == 1 .And. nTpImpre == 1
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Incializa impressao                                              ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู

	oSecCab:Init()
	oSection1:Init()
	cUserFilt := oSecCab:GetUserExp( "SRA",.T.)
 
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Define o total da regua da tela de processamento do relatorio    ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	oReport:SetMeter( SRA->(RecCount()) )
Else
	If FunName() != "GPER060"
		ProcRegua(SRA->(RecCount()))
	EndIf
EndIf

	cCamposSRA := "%RA_FILIAL, RA_MAT, RA_NOME, RA_CC, RA_PROCES, RA_CODRET%"

	cWhereSRA := "%SRA.RA_FILIAL >= " + "'" + cFilDe  + "'" + " AND "
	cWhereSRA += "SRA.RA_FILIAL <= " + "'" + cFilAte + "'" + " AND "
	cWhereSRA += "SRA.RA_MAT >= " + "'" + cMatDe + "'" + " AND "
	cWhereSRA += "SRA.RA_MAT <= " + "'" + cMatAte + "' " 
	If FunName() == "GPER060"
		cWhereSRA += "AND SRA.RA_TPCONTR IN (" + fSqlIN(cTpC1, 1) + ")" 
	EndIf	
	If !empty(cUserFilt)
		cWhereSRA += " AND " + cUserFilt
	EndIf	
	cWhereSRA +=  "%"

	//Filtra filiais de acesso do usuario
	cValidFil := "%RA_FILIAL IN ('' "
	For nX := 1 to Len(aValidFil)
		cValidFil += ", '" + aValidFil[nX] + "' "
	Next nX
	cValidFil += ") %"

	If Select(cAliasSRA) > 0
		(cAliasSRA)->( dbCloseArea() )
	EndIf

	BeginSql alias cAliasSRA
		SELECT %exp:cCamposSRA%
		FROM  %table:SRA% SRA
		WHERE %exp:cWhereSRA% AND %exp:cValidFil% AND SRA.%notDel%	
		ORDER BY %exp:cOrderSRA%
	EndSql

IF nTipImp == 2
	oPrint:StartPage()  //Inicio da Pแgina
ENDIF
While (cAliasSRA)->(!EoF())

	//Posiciona na SRA para que os filtros personalizados sejam executados.
	SRA->(DbSetOrder(1))
	SRA->(DbSeek((cAliasSRA)->(RA_FILIAL + RA_MAT)))

	cOldRet := (cAliasSRA)->RA_CODRET
	cSRACodRet := If(Empty(cOldRet), "0561", cOldRet)

	If !Empty(cFiltro) .And. !SRA->(&(cFiltro))
		fTestaTotal()
		Loop
	EndIf	

	If !lGeraTitulo .and. nTpImpre # 1
		If lPlr
			cOldRet := "3562"
		EndIf
	EndIf 

	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Movimenta Cursor                                          ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	If nTipImp == 1 .And. nTpImpre == 1
		oReport:IncMeter(1)
	Else
		If FunName() != "GPER060"
			If lGeraTitulo
				IncProc(STR0019) //"Gerando Titulos - Imposto de Renda"
			Else
				IncProc(STR0055) //"Aguarde..."
			EndIf
		EndIf
	EndIf

	If lEnd
		Exit
	EndIf
	
	If (cAliasSRA)->RA_FILIAL # cFilQuebra .or. Empty(aCodFol)
		//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
		//ณ Carregar os periodos abertos (aPerAberto) e/ou os periodos   ณ
		//ณ fechados (aPerFechado), de acordo com uma determinada compe- ณ
		//ณ tencia.                 									 ณ
		//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
		aPerAberto 	:= {}
		aPerFechado := {}
		fRetPerComp( Month2Str( dDataDe ), Year2Str(dDataDe ), xFilial('RCH', (cAliasSRA)->RA_FILIAL), Nil, Nil, @aPerAberto, @aPerFechado,Nil,.T.,dDataDe,dDataAte)
		//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
		//ณ Carrega verbas que serao processadas                         ณ
		//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู		
		If !RetVerPro(@aVerba, xFilial('SRV', (cAliasSRA)->RA_FILIAL))
			//Help alertando que nao carregou verbas para filial - SRA->RA_FILIAL - nao tenho acesso para AtuSx
			Exit
		Endif

		If Empty(cCentra) .Or. nTpImpre == 1
			fInfo(@aInfo, (cAliasSRA)->RA_FILIAL)
		EndIf		

  		If cFilQuebra != Replicate("!", FWGETTAMFILIAL) .And. ( Empty(cCentra) .Or. nTpImpre == 1 )
			fImpFil()    // Totaliza Filial
		EndIf
	EndIf

	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Consiste Parametrizacao do Intervalo de Impressao            ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	If ((cAliasSRA)->RA_NOME   < cNomDe) .Or. ((cAliasSRA)->RA_NOME   > cNomAte)  .Or. ;
	   ((cAliasSRA)->RA_MAT    < cMatDe) .Or. ((cAliasSRA)->RA_MAT    > cMatAte)  .Or. ;
	   ((cAliasSRA)->RA_CC     < cCcDe ) .Or. ((cAliasSRA)->RA_CC     > cCcAte )  .Or. ;
	   ((cAliasSRA)->RA_FILIAL < cFilDe) .Or. ((cAliasSRA)->RA_FILIAL > cFilAte)
		fTestaTotal()
		Loop
	EndIf

	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Consiste controle de acessos e filiais validas               ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	If !((cAliasSRA)->RA_FILIAL $ fValidFil()) .Or. !Eval(cAcessaSRA)
		fTestaTotal()
		Loop
	EndIf

	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Ponto de Entrada para desprezar funcionario caso retorne .T. ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	If lGp050Fil	
		lRetPE := ExecBlock( "GP050FIL", .F., .F. )
		If ( ( ValType(lRetPE) == "L" ) .and. lRetPE )
			fTestaTotal() 
			Loop
		EndIf
	EndIf 
	
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Contera as verbas ja lidas - evitara que nao sejam duplicadasณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู	
	aCodLido := {}  
	
	lIRMesAnt := .T.

	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Carrega as transferencias do funcionario                     ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	fVerTransf( .F., aTransf , dDataDe, cEmpAnt, (cAliasSRA)->RA_FILIAL, (cAliasSRA)->RA_MAT )

	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Processa movimento SRC / SRD                                 ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู	
	ProcMovime(aPerAberto, aPerFechado, aVerba)
	
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Nao processa SRC/SRD se o funcionario tem rescisao          ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	dbSelectArea( "SRG" )
	If SRG->(dbSeek( (cAliasSRA)->(RA_FILIAL+RA_MAT) ))
		ProcRescisao()
	EndIf
	
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Procura no SRH Funcionarios em Ferias                        ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	If !lPLR
		ProcFerias()
	EndIf
	//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
	//ณ Totalizador                                                  ณ
	//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
	dbSelectArea((cAliasSRA))
	If	FTotAcumuladores(4,4) == 0
		fTestaTotal()
		Loop
	Endif
	fImpFun()
	fTestaTotal()
Enddo
IF nTipImp == 2
	oPrint:EndPage() 
ENDIF

Return()

Static Function fPosQuebra()
	oReport:SkipLine(2)
	oReport:FatLine()
	oReport:SkipLine(1)
Return

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณChkDtPag Autor  ณRH      		         บ Data ณ  11/06/18   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณVerifica se existem valor gerado no m๊s anterior a transfer_บฑฑ
ฑฑบ          ณencia com data de pagamento posterior เ mesma.              บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ GPER050			                                          บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿*/

Static Function ChkDtPag(cProcAux)

Local cQrAlias := GetNextAlias()
Local lRet := .F.

BeginSql alias cQrAlias                             
			
	SELECT SRD.R_E_C_N_O_	
    FROM  %table:SRD% SRD 
		       
    WHERE SRD.%notDel% AND 
    SRD.RD_FILIAL = %exp:(SRA->RA_FILIAL)% AND
    SRD.RD_MAT = %exp:(SRA->RA_MAT)% AND 
    SRD.RD_DATPGT BETWEEN %exp:(MV_PAR07)% AND %exp:(MV_PAR08)% AND
    SRD.RD_PROCES = %exp:(cProcAux)% AND 
    SRD.RD_PD = %exp:(aCodFol[66,1])%  
				
EndSql

If((cQrAlias)->(!Eof()))
	lRet := .T.
EndIf

(cQrAlias)->(dbCloseArea())

Return lRet 



Static Function fTrataVer(aVerbas)
Local cVerbas 	:= ""
Local nI 		:= 1

For nI := 1 To Len(aVerbas)
	cVerbas += "'" + aVerbas[nI][1] + "'," 
Next nI
If !Empty(cVerbas)
	cVerbas := subStr(cVerbas,1,Len(cVerbas)-1)   
EndIf  

Return cVerbas